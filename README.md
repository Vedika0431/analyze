# Data Processing & CI/CD Project\n\nThis project provides a comprehensive solution for data processing, including reading from Excel, converting to CSV, performing sample transformations, and outputting to JSON. It's fully integrated with a GitHub Actions CI/CD pipeline for automated linting, execution, and deployment of results to GitHub Pages.\n\n## Project Structure\n\n*   `data.xlsx`: The source Excel file containing raw data.\n*   `execute.py`: A Python script responsible for reading `data.xlsx`, converting it to `data.csv`, processing the data, and generating `result.json`.\n*   `data.csv`: The CSV version of `data.xlsx`, generated by `execute.py`. (Not committed, generated at runtime if not present, or generated during CI).\n*   `result.json`: The processed output data in JSON format, generated by `execute.py`. (Not committed, generated during CI and published to GitHub Pages).\n*   `.github/workflows/ci.yml`: Defines the GitHub Actions workflow for linting, building, and deployment.\n*   `index.html`: A single-file responsive HTML application using Tailwind CSS to provide an overview and access to the published results.\n*   `README.md`: This documentation file.\n*   `LICENSE`: The MIT License for the project.\n\n## Setup and Requirements\n\n*   **Python 3.11+**: The project is developed and tested with Python 3.11 and newer versions.\n*   **Pandas 2.3**: The primary library for data manipulation.\n*   **Ruff**: Used for code linting and formatting.\n*   `openpyxl`: Required by Pandas to read `.xlsx` files.\n\nYou can install the necessary Python packages using pip:\n\n```bash\npip install pandas openpyxl ruff\n```\n\n## `execute.py` - Functionality and Fixes\n\nThe `execute.py` script performs the following steps:\n1.  **Reads `data.xlsx`**: It reads the raw data from the Excel spreadsheet.\n2.  **Converts to `data.csv`**: The Excel data is immediately converted and saved as `data.csv`. This ensures a plain text version of the data is available.\n3.  **Processes Data**: It performs a sample data processing step (e.g., converting the DataFrame into a list of dictionaries for JSON serialization).\n4.  **Generates `result.json`**: The processed data is then saved as `result.json`.\n\n### Non-Trivial Error Fixes Implemented:\n\nThe original `execute.py` had a non-trivial error that has been addressed to make the script more robust and reliable:\n*   **File Existence Validation**: Added explicit checks to ensure `data.xlsx` exists before attempting to read it, preventing `FileNotFoundError` during script execution.\n*   **Pandas `read_excel` Robustness**: Ensured the use of `engine='openpyxl'` for `pd.read_excel` to guarantee compatibility with modern `.xlsx` files and robust parsing.\n*   **Comprehensive Error Handling**: Implemented `try-except` blocks to catch specific issues like `FileNotFoundError`, `pd.errors.EmptyDataError` (for malformed or empty Excel files), and general `Exception`s, providing informative error messages and proper script exit codes for CI environments.\n*   **Robust JSON Serialization**: The DataFrame is converted to a list of dictionaries using `df.to_dict(orient='records')`, which is a reliable way to serialize tabular data to JSON. `json.dump` is used with `indent=4` for readability and `ensure_ascii=False` for better support of non-ASCII characters.\n\n## Running the Script Locally\n\n1.  Ensure you have Python 3.11+ and the required packages installed.\n2.  Place `data.xlsx` in the same directory as `execute.py`.\n3.  Run the script:\n    ```bash\n    python execute.py\n    ```\n    This will generate `data.csv` and `result.json` in the current directory.\n\n## Code Quality\n\nTo check code quality using Ruff:\n\n```bash\nruff check .\n```\n\n## GitHub Actions CI/CD Workflow (`.github/workflows/ci.yml`)\n\nA GitHub Actions workflow is set up to automate the entire process on every push to the `main` branch.\n\n### Workflow Steps:\n\n1.  **Linting (`lint` job)**:\n    *   Checks out the repository.\n    *   Sets up Python 3.11.\n    *   Installs `ruff`.\n    *   Runs `ruff check .` to enforce code quality standards. If linting fails, the workflow stops.\n\n2.  **Build and Publish (`build-and-publish` job)**:\n    *   **Dependencies**: This job `needs` the `lint` job to complete successfully.\n    *   Checks out the repository.\n    *   Sets up Python 3.11.\n    *   Installs `pandas` and `openpyxl`.\n    *   **Execution**: Runs `python execute.py > result.json`. This command executes the data processing script, converting `data.xlsx` to `data.csv` internally and then writing its final JSON output to `result.json`.\n    *   **GitHub Pages Setup**: Configures the GitHub Pages environment.\n    *   **Upload Artifact**: The generated `result.json` is uploaded as a Pages artifact.\n    *   **Deploy to GitHub Pages**: The artifact (containing `result.json`) is deployed, making it accessible via your repository's GitHub Pages URL (e.g., `https://your-username.github.io/your-repo/result.json`).\n\n## Accessing `result.json`\n\nOnce the CI/CD pipeline completes successfully, `result.json` will be published to GitHub Pages. You can access it directly at:\n\n`https://your-username.github.io/your-repository/result.json`\n\n(Replace `your-username` and `your-repository` with your actual GitHub details.)\n